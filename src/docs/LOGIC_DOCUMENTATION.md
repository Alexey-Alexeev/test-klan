# Документация по функциональности "Логика"

## Обзор

Функциональность "Логика" в BDUI редакторе позволяет создавать интерактивные интерфейсы с динамическим поведением. Она включает в себя управление состоянием, событиями, действиями и привязками данных.

## Основные компоненты

### 1. Вкладка "Логика" (Logic Tab)

**Назначение:** Создание и управление событиями на уровне экрана.

**Как использовать:**
1. Перейдите на вкладку "Логика"
2. Нажмите "Новое Событие" для создания события
3. Настройте триггер события (по клику, при изменении, при загрузке и т.д.)
4. Добавьте условия (необязательно)
5. Сохраните событие

**Типы триггеров:**
- **По клику** - срабатывает при нажатии на элемент
- **Долгое нажатие** - срабатывает при удержании элемента
- **При изменении** - срабатывает при изменении значения ввода
- **При загрузке** - срабатывает при загрузке экрана
- **При инициализации** - срабатывает при инициализации компонента
- **Пользовательское событие** - срабатывает при вызове из кода

### 2. Вкладка "Данные" в панели свойств

**Назначение:** Управление привязками данных между UI элементами и переменными состояния.

**Как использовать:**

#### Создание переменных состояния:
1. Выберите элемент на холсте
2. Перейдите на вкладку "Данные" в панели свойств
3. Нажмите "Добавить Переменную"
4. Выберите область видимости:
   - **App** - глобальные переменные приложения
   - **Screen** - переменные экрана
5. Укажите имя, тип и значение по умолчанию

#### Привязка свойств к данным:
1. В разделе "Привязки Свойств" выберите свойство элемента
2. Введите выражение для привязки, например:
   - `{screen.cart.total}` - для отображения суммы корзины
   - `{app.user.name}` - для отображения имени пользователя
   - `{screen.items.length > 0}` - для условного отображения

#### Типы переменных:
- **Строка** - текстовые данные
- **Число** - числовые значения
- **Логический** - true/false значения
- **Массив** - списки данных
- **Объект** - сложные структуры данных

### 3. Вкладка "Действия" в панели свойств

**Назначение:** Настройка действий, которые выполняются при взаимодействии с элементами.

**Как использовать:**

#### Добавление действий:
1. Выберите элемент на холсте
2. Перейдите на вкладку "Действия"
3. Нажмите "Добавить" для создания нового действия
4. Выберите тип действия из списка

#### Типы действий:

**1. Обновить Состояние**
- Изменяет значения переменных состояния
- Операции: установить, увеличить, уменьшить
- Пример: `screen.cart.total += item.price`

**2. Навигация**
- Переходы между экранами
- Открытие модальных окон
- Возврат назад

**3. Пересчитать**
- Выполнение формул для обновления состояния
- Пример: `screen.cart.total = screen.cart.items.reduce((sum, item) => sum + item.price, 0)`

**4. API Вызов**
- Выполнение HTTP запросов
- Отправка данных на сервер
- Получение данных с сервера

**5. Отправить Событие**
- Запуск пользовательских событий
- Связывание элементов между собой

**6. Условие**
- Условная логика
- Выполнение действий только при определенных условиях

**7. Уведомление**
- Показ toast сообщений
- Информирование пользователя

#### Настройка действий:

**Условия выполнения:**
- Добавьте условия для выполнения действий
- Используйте выражения: `{screen.cart.total > 100}`
- Несколько условий объединяются через AND

**Последовательность выполнения:**
- Действия выполняются в порядке добавления
- Можно изменить порядок перетаскиванием
- Каждое действие может иметь условия

**Обработка ошибок:**
- Настройте действия при успешном выполнении
- Настройте действия при ошибке
- Используйте fallback логику

## Практические примеры

### Пример 1: Кнопка добавления в корзину

1. **Создайте переменную состояния:**
   - Область: Screen
   - Имя: `cart`
   - Тип: Массив
   - Значение: `[]`

2. **Настройте действие кнопки:**
   - Тип: "Обновить Состояние"
   - Цель: `screen.cart`
   - Операция: "Добавить элемент"
   - Значение: `{item}`

3. **Добавьте уведомление:**
   - Тип: "Уведомление"
   - Сообщение: "Товар добавлен в корзину"

### Пример 2: Условное отображение

1. **Создайте переменную:**
   - Область: Screen
   - Имя: `isLoggedIn`
   - Тип: Логический
   - Значение: `false`

2. **Настройте привязку видимости:**
   - Элемент: Кнопка "Выйти"
   - Свойство: `style.display`
   - Привязка: `{screen.isLoggedIn ? 'block' : 'none'}`

### Пример 3: Форма с валидацией

1. **Создайте переменные:**
   - `screen.form.email` (Строка)
   - `screen.form.errors` (Объект)

2. **Настройте действия поля email:**
   - При изменении: Проверить валидность
   - Условие: `{screen.form.email.includes('@')}`
   - При успехе: Очистить ошибку
   - При ошибке: Показать сообщение об ошибке

## Лучшие практики

### 1. Именование переменных
- Используйте понятные имена: `cart.total` вместо `ct.t`
- Группируйте связанные переменные: `user.name`, `user.email`
- Используйте camelCase для JavaScript совместимости

### 2. Структура состояния
```
app/
  ├── user (объект)
  │   ├── name (строка)
  │   ├── email (строка)
  │   └── isLoggedIn (логический)
  └── theme (строка)

screen/
  ├── cart (массив)
  ├── total (число)
  └── isLoading (логический)
```

### 3. Управление событиями
- Создавайте события на уровне экрана для общей логики
- Используйте пользовательские события для связи компонентов
- Группируйте связанные действия в одно событие

### 4. Производительность
- Минимизируйте количество переменных состояния
- Используйте условия для предотвращения ненужных обновлений
- Группируйте связанные обновления состояния

## Отладка

### Инструменты разработчика
1. **Панель состояния** - просмотр текущих значений переменных
2. **Лог событий** - отслеживание выполнения действий
3. **Предпросмотр** - тестирование интерактивности

### Частые проблемы
1. **Циклические зависимости** - избегайте действий, которые вызывают сами себя
2. **Неопределенные переменные** - всегда инициализируйте переменные
3. **Неправильные выражения** - проверяйте синтаксис привязок

## Заключение

Функциональность "Логика" превращает статичные интерфейсы в динамические приложения. Используйте её для создания интерактивных форм, навигации, управления состоянием и интеграции с API.

Начните с простых примеров и постепенно переходите к более сложным сценариям использования.
